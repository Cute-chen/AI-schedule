import{e as A,w as M}from"./index-bcd0f302.js";/* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                     *//* empty css               *//* empty css                *//* empty css                     */import{_ as B}from"./_plugin-vue_export-helper-8da67cfc.js";/* empty css                  */import{W as D}from"./WeekRangeSelector-08a2a9b6.js";import{E as i,a2 as C,a4 as F,a5 as T,X as N,p as q,_ as z,aj as O,M as P,ak as U}from"./elementPlus-9365ac08.js";import{r as g,X,k as $,y as p,z as w,A as d,Q as a,I as t,P as h,a4 as E,M as c,O as _,H as I}from"./vendor-b2a91a46.js";import"./utils-88d415ea.js";/* empty css                 *//* empty css                        */import"./settingsService-87306db1.js";const j={class:"work-hours-statistics"},L={class:"weekly-detail"},Q={__name:"WorkHoursStatistics",setup(G){const m=g(!1),n=g([]),u=g([]),l=X({employeeId:"",weekRange:[1,4]}),x=async()=>{var s;try{const e=await A.getEmployees();console.log("员工API响应:",e),e.success?n.value=((s=e.data)==null?void 0:s.data)||e.data||[]:e.data?n.value=Array.isArray(e.data)?e.data:e.data.data||[]:n.value=[],console.log("加载的员工数据:",n.value)}catch(e){console.error("加载员工列表失败:",e),i.error("加载员工列表失败")}},H=async()=>{if(!l.weekRange||l.weekRange.length===0){i.warning("请选择周期范围");return}m.value=!0;try{const s={startWeek:Math.min(...l.weekRange),endWeek:Math.max(...l.weekRange)};l.employeeId&&(s.employeeId=l.employeeId),console.log("查询参数:",s);const e=await M.getAllEmployeesWorkHours(s);e.success?(l.employeeId?u.value=[e.data]:u.value=e.data.employees||[],console.log("工时数据:",u.value),i.success("工时统计查询成功")):i.error(e.message||"查询工时统计失败")}catch(s){console.error("查询工时统计失败:",s),i.error("查询工时统计失败")}finally{m.value=!1}};return $(()=>{x()}),(s,e)=>{const k=F,V=T,y=N,W=q,R=z,v=C,r=O,b=P,S=U;return p(),w("div",j,[e[4]||(e[4]=d("div",{class:"page-header"},[d("h1",null,"📊 工时统计"),d("p",null,"查看员工工时数据")],-1)),a(v,{class:"filter-section"},{default:t(()=>[a(R,{model:l,inline:""},{default:t(()=>[a(y,{label:"员工选择"},{default:t(()=>[a(V,{modelValue:l.employeeId,"onUpdate:modelValue":e[0]||(e[0]=o=>l.employeeId=o),placeholder:"选择员工（空为全部）",clearable:"",style:{width:"200px"}},{default:t(()=>[a(k,{label:"全部员工",value:""}),(p(!0),w(h,null,E(n.value,o=>(p(),I(k,{key:o.id,label:`${o.name} (${o.employee_no})`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(y,{label:"周期范围"},{default:t(()=>[a(D,{modelValue:l.weekRange,"onUpdate:modelValue":e[1]||(e[1]=o=>l.weekRange=o),"max-weeks":52},null,8,["modelValue"])]),_:1}),a(y,null,{default:t(()=>[a(W,{type:"primary",onClick:H,loading:m.value},{default:t(()=>e[2]||(e[2]=[c(" 查询 ",-1)])),_:1,__:[2]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),a(v,{class:"data-section"},{header:t(()=>e[3]||(e[3]=[d("span",null,"工时统计结果",-1)])),default:t(()=>[a(S,{data:u.value,stripe:"",loading:m.value,"empty-text":"暂无工时数据，请先查询"},{default:t(()=>[a(r,{prop:"employeeInfo.name",label:"员工姓名",width:"120"}),a(r,{prop:"employeeInfo.employee_no",label:"员工编号",width:"120"}),a(r,{prop:"employeeInfo.position",label:"职位",width:"120"}),a(r,{prop:"statistics.totalHours",label:"总工时",width:"100"},{default:t(o=>[a(b,{type:"primary"},{default:t(()=>[c(_(o.row.statistics.totalHours)+"h",1)]),_:2},1024)]),_:1}),a(r,{prop:"statistics.workDays",label:"工作天数",width:"100"}),a(r,{prop:"statistics.totalShifts",label:"总班次",width:"100"}),a(r,{prop:"statistics.averageDailyHours",label:"日均工时",width:"100"},{default:t(o=>[c(_(o.row.statistics.averageDailyHours)+"h ",1)]),_:1}),a(r,{label:"按周明细","min-width":"300"},{default:t(o=>[d("div",L,[(p(!0),w(h,null,E(o.row.statistics.weeklyStats,f=>(p(),I(b,{key:f.week,size:"small",style:{"margin-right":"5px","margin-bottom":"2px"}},{default:t(()=>[c(" 第"+_(f.week)+"周: "+_(f.hours)+"h ",1)]),_:2},1024))),128))])]),_:1})]),_:1},8,["data","loading"])]),_:1})])}}},ce=B(Q,[["__scopeId","data-v-f5e472ca"]]);export{ce as default};
