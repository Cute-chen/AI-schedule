import{u as et,a as x}from"./index-bcd0f302.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                     *//* empty css                       *//* empty css                 *//* empty css                     */import{_ as tt}from"./_plugin-vue_export-helper-8da67cfc.js";/* empty css                *//* empty css                    *//* empty css                 *//* empty css                 *//* empty css                          *//* empty css                    *//* empty css               */import{aC as at,r as g,X as re,c as ve,f as st,k as lt,y as u,z as _,A as a,Q as s,I as o,u as w,M as f,O as c,L,P as z,a4 as M,a5 as ot,J as nt,H as it,C as K}from"./vendor-b2a91a46.js";import{B as pe,D as rt,H as ge,G as dt,U as we,ay as ke,az as ct,aa as he,C as ut,E as y,k as De,c as mt,p as _t,M as ft,_ as yt,ae as vt,a8 as pt,W as gt,a3 as wt,ag as kt,a2 as ht,ap as Dt,X as bt,aq as St,S as Ct,T as It,a9 as Wt,Y as At,af as Vt}from"./elementPlus-9365ac08.js";import{W as be}from"./WeekRangeSelector-08a2a9b6.js";import{s as de}from"./settingsService-87306db1.js";import"./utils-88d415ea.js";/* empty css                        */const $t={class:"availability-management"},Tt={class:"page-header"},Et={class:"header-content"},zt={class:"header-actions"},Mt={class:"operation-content"},xt={class:"operation-form"},Bt={class:"form-section"},Ft={class:"section-title"},Nt={class:"section-content"},Ut={key:0,class:"week-info"},Yt={class:"form-section"},Ot={class:"section-title"},Lt={class:"section-content"},jt={class:"weekday-grid"},Pt={class:"weekday-header"},Rt={class:"weekday-name"},Gt={key:0,class:"time-slot-list"},Ht={class:"time-slot-info"},Kt={class:"slot-name"},Xt={class:"slot-time"},qt={class:"form-actions"},Jt={class:"operation-content"},Qt={class:"operation-form"},Zt={class:"form-section"},ea={class:"section-title"},ta={class:"section-content"},aa={key:0,class:"week-info"},sa={class:"form-section"},la={class:"section-title"},oa={class:"section-content"},na={class:"weekday-grid"},ia={class:"weekday-header"},ra={class:"weekday-name"},da={key:0,class:"time-slot-list"},ca={class:"time-slot-info"},ua={class:"slot-name"},ma={class:"slot-time"},_a={class:"form-actions"},fa={class:"operation-content"},ya={class:"availability-list"},va={class:"week-nav-controls"},pa={class:"week-nav"},ga={class:"current-week"},wa={class:"week-number-info"},ka={class:"week-number"},ha={class:"week-search"},Da={class:"search-input"},ba={class:"search-hint"},Sa={class:"availability-calendar"},Ca={class:"calendar-grid"},Ia={class:"calendar-header"},Wa={class:"day-name"},Aa={class:"day-date"},Va={class:"time-cell"},$a={class:"time-name"},Ta={class:"time-period"},Ea={class:"status-content"},za={class:"my-availability-list"},Ma={class:"availability-info"},xa={class:"priority-display"},Ba={class:"priority-stars"},Fa={class:"priority-text"},Na={key:0,class:"notes-display"},Ua={class:"availability-actions"},Ya={__name:"Availability",setup(Oa){at();const ee=et(),E=g("add"),B=g([]),V=g([]),$=g([]),F=g(!1),te=g(!1),j=g([]),X=g(!1),q=g([]),b=g(new Date),P=g([]),ae=g(""),R=g(!1),se=g(1),J=g(""),G=g(52),p=re({id:"",employeeId:"",timeSlotId:"",date:"",priority:3,notes:""}),H=["周日","周一","周二","周三","周四","周五","周六"],k=re({weekdaySelections:[{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]}]}),D=re({weekdaySelections:[{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]},{enabled:!1,timeSlotIds:[]}]}),Se=ve(()=>V.value.length>0&&k.weekdaySelections.some(t=>t.enabled&&t.timeSlotIds.length>0)),Ce=ve(()=>$.value.length>0),Ie=()=>V.value.length===0?"":`第${[...V.value].sort((e,l)=>e-l).join("、")}周`,We=()=>$.value.length===0?"":`第${[...$.value].sort((e,l)=>e-l).join("、")}周`,Ae=t=>{V.value=t},Ve=t=>{$.value=t},$e=t=>{k.weekdaySelections[t].enabled||(k.weekdaySelections[t].timeSlotIds=[])},Te=t=>{D.weekdaySelections[t].enabled||(D.weekdaySelections[t].timeSlotIds=[])},ce=()=>{V.value=[],k.weekdaySelections.forEach(t=>{t.enabled=!1,t.timeSlotIds=[]})},ue=()=>{$.value=[],D.weekdaySelections.forEach(t=>{t.enabled=!1,t.timeSlotIds=[]})},Ee=async()=>{const t=[];if(V.value.length===0&&t.push("周范围"),k.weekdaySelections.some(l=>l.enabled&&l.timeSlotIds.length>0)||t.push("至少一个星期几的时间段"),t.length>0){y.warning(`请先选择：${t.join("、")}`);return}await Me()},le=async(t,e)=>{try{const l=await de.getWeekStartDate(),n=new Date(l);return n.setDate(l.getDate()+(e-1)*7),n}catch(l){console.error("获取周开始日期失败:",l);const n=new Date(t,0,1),d=n.getDay(),v=new Date(n),W=d===0?1:8-d;v.setDate(n.getDate()+W);const h=new Date(v);return h.setDate(v.getDate()+(e-1)*7),h}},me=async t=>{try{const e=await de.getWeekStartDate(),l=new Date(t),n=Math.floor((l-e)/(1e3*60*60*24)),d=Math.floor(n/7)+1;return Math.max(1,d)}catch(e){console.error("计算周次失败:",e);const l=t.getFullYear(),n=new Date(l,0,1),d=Math.floor((t-n)/(24*60*60*1e3));return Math.ceil((d+n.getDay()+1)/7)}},_e=async()=>{const t=parseInt(J.value);if(!t||t<1||t>G.value){y.warning(`请输入有效的周次 (1-${G.value})`);return}try{const e=await le(new Date().getFullYear(),t);b.value=e,await N(),await U(),await Y(),await S(),J.value="",y.success(`已跳转到第${t}周`)}catch(e){console.error("跳转周次失败:",e),y.error("跳转失败，请重试")}},N=async()=>{try{se.value=await me(b.value)}catch(t){console.error("更新当前周次失败:",t),se.value=1}},ze=async()=>{try{const t=new Date().getFullYear(),e=new Date(t+1,0,1),l=new Date(e.getTime()-24*60*60*1e3);G.value=await me(l)}catch(t){console.error("计算最大周数失败:",t),G.value=52}},Me=async()=>{var t;if(!Se.value){y.error("请检查表单填写是否完整");return}F.value=!0;try{let e=0,l=0;for(const n of V.value){const d=await le(new Date().getFullYear(),n);for(let v=0;v<7;v++){const W=k.weekdaySelections[v];if(W.enabled&&W.timeSlotIds.length>0){const h=new Date(d);console.log(`员工界面-选择的dayIndex=${v}(${H[v]}), weekStartDate=${d.toDateString()}(星期${d.getDay()})`);const C=d.getDay();let T=v-C;T<0&&(T+=7),h.setDate(d.getDate()+T),console.log(`员工界面-目标日期: ${h.toDateString()}(星期${h.getDay()})`);for(const A of W.timeSlotIds){l++;try{await x.createAvailability({employeeId:ee.userInfo.id,timeSlotId:A,date:h.toISOString().split("T")[0],priority:3}),e++}catch(I){console.error("创建空闲时间失败:",I),((t=I.response)==null?void 0:t.status)===409&&e++}}}}}e===l?y.success(`成功批量添加 ${e} 条空闲时间记录`):y.warning(`已添加 ${e}/${l} 条空闲时间记录，部分失败可能由于重复记录`),ce(),E.value==="list"&&S()}catch(e){console.error("批量添加空闲时间失败:",e),y.error("批量添加空闲时间失败，请重试")}finally{F.value=!1}},xe=async()=>{const t=[];if($.value.length===0&&t.push("周范围"),t.length>0){y.warning(`请先选择：${t.join("、")}`);return}await Be()},Be=async()=>{try{await De.confirm("确认要删除选中周范围内的空闲时间记录吗？此操作不可撤销。","确认删除",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),await Fe()}catch{}},Fe=async()=>{var t;if(!Ce.value){y.error("请至少选择一个周");return}te.value=!0;try{let e=0,l=0;const n=await x.getAvailabilities({employeeId:ee.userInfo.id}),d=Array.isArray(n.data)?n.data:((t=n.data)==null?void 0:t.data)||[];for(const v of $.value){const W=await le(new Date().getFullYear(),v),h=d.filter(C=>{const T=new Date(C.date),A=new Date(W),I=new Date(A);return I.setDate(A.getDate()+6),T>=A&&T<=I});for(const C of h){const A=new Date(C.date).getDay(),I=D.weekdaySelections[A];let O=!1;if(I.enabled?I.timeSlotIds.length>0?O=I.timeSlotIds.includes(C.timeSlotId):O=!0:O=!D.weekdaySelections.some(ne=>ne.enabled),O){l++;try{await x.deleteAvailability(C.id),e++}catch(Z){console.error("删除空闲时间失败:",Z)}}}}e===l?y.success(`成功批量删除 ${e} 条空闲时间记录`):y.warning(`已删除 ${e}/${l} 条空闲时间记录`),ue(),E.value==="list"&&S()}catch(e){console.error("批量删除空闲时间失败:",e),y.error("批量删除空闲时间失败，请重试")}finally{te.value=!1}},fe=async()=>{try{const t=await x.getTimeSlots();console.log("时间段API响应:",t);let e=t.data;e&&typeof e=="object"&&!Array.isArray(e)&&(e=e.data||e.timeSlots||e.items||[]),B.value=Array.isArray(e)?e:[],console.log("处理后的时间段数据:",B.value)}catch(t){console.error("获取时间段失败:",t),B.value=[],y.error("获取时间段失败")}},Ne=()=>{fe(),E.value==="list"&&S()},S=async()=>{X.value=!0;try{const t={employeeId:ee.userInfo.id},e=await oe(b.value),l=new Date(e);l.setDate(e.getDate()+6),t.startDate=e.toISOString().split("T")[0],t.endDate=l.toISOString().split("T")[0],console.log("获取空闲时间参数:",t);const n=await x.getAvailabilities(t);console.log("空闲时间API响应:",n);let d=n.data;d&&typeof d=="object"&&!Array.isArray(d)&&(d=d.data||d.availabilities||d.items||[]),j.value=Array.isArray(d)?d:[],console.log("处理后的空闲时间数据:",j.value)}catch(t){console.error("获取我的空闲时间失败:",t),y.error("获取空闲时间列表失败"),j.value=[]}finally{X.value=!1}},Ue=async t=>{var e;try{await De.confirm(`确认要删除 ${Oe(t.date)} ${je(t.date)} 的 ${((e=t.timeSlot)==null?void 0:e.name)||"未知时间段"} 空闲时间记录吗？`,"确认删除",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),await Ye(t)}catch{}},Ye=async t=>{q.value.push(t.id);try{await x.deleteAvailability(t.id),y.success("删除成功"),S()}catch(e){console.error("删除空闲时间失败:",e),y.error("删除失败，请重试")}finally{q.value=q.value.filter(e=>e!==t.id)}},Oe=t=>{if(!t)return"-";const e=new Date(t);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},Q=t=>t.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}),Le=t=>{const e=new Date;return t.toDateString()===e.toDateString()},je=t=>{if(!t)return"-";const e=new Date(t);return H[e.getDay()]},oe=async t=>{try{return await de.calculateWeekStart(t)}catch(e){console.error("计算周开始日期失败:",e);const l=new Date(t),n=l.getDay(),d=l.getDate()-n+(n===0?-6:1);return new Date(l.setDate(d))}},U=async()=>{try{const t=await oe(b.value);console.log("周开始日期:",t);const e=[];for(let l=0;l<7;l++){const n=new Date(t);n.setDate(t.getDate()+l),e.push({date:n,name:H[n.getDay()]})}P.value=e,console.log("计算的周天数:",P.value)}catch(t){console.error("计算列表周天数失败:",t),P.value=[]}},Y=async()=>{try{const t=await oe(b.value),e=new Date(t);e.setDate(t.getDate()+6),ae.value=`${Q(t)} - ${Q(e)}`}catch(t){console.error("更新列表周范围文本失败:",t),ae.value=Q(b.value)}},Pe=async()=>{const t=new Date(b.value);t.setDate(t.getDate()-7),b.value=t,await N(),await U(),await Y(),await S()},Re=async()=>{const t=new Date(b.value);t.setDate(t.getDate()+7),b.value=t,await N(),await U(),await Y(),await S()},Ge=async()=>{b.value=new Date,await N(),await U(),await Y(),await S()},ye=(t,e)=>{const l=e.toISOString().split("T")[0];return j.value.filter(n=>(n.timeSlotId===t||n.time_slot_id===t)&&n.date===l)},He=(t,e)=>ye(t,e).length===0?"empty":"has-my-availability",Ke=t=>{p.id=t.id,p.employeeId=t.employeeId||t.employee_id,p.timeSlotId=t.timeSlotId||t.time_slot_id,p.date=t.date,p.priority=t.priority||3,p.notes=t.notes||"",R.value=!0},Xe=async()=>{try{F.value=!0;const t={priority:p.priority,notes:p.notes};await x.updateAvailability(p.id,t),R.value=!1,await S(),y.success("修改成功")}catch(t){console.error("修改失败:",t),y.error("修改失败")}finally{F.value=!1}};return st(E,async t=>{t==="list"&&(await N(),await U(),await Y(),await S())}),lt(async()=>{await fe(),await ze(),await N(),await U(),await Y(),E.value==="list"&&await S()}),(t,e)=>{const l=mt,n=_t,d=ft,v=At,W=Vt,h=yt,C=vt,T=pt,A=gt,I=wt,O=kt,Z=ht,ne=Dt,ie=bt,qe=St,Je=Ct,Qe=It;return u(),_("div",$t,[a("div",Tt,[a("div",Et,[e[11]||(e[11]=a("div",{class:"header-info"},[a("h1",null,"空闲时间管理"),a("p",null,"管理您的空闲时间安排，系统会根据这些信息进行排班分配")],-1)),a("div",zt,[s(n,{onClick:e[0]||(e[0]=i=>t.$router.go(-1)),size:"default"},{default:o(()=>[s(l,null,{default:o(()=>[s(w(pe))]),_:1}),e[9]||(e[9]=f(" 返回 ",-1))]),_:1,__:[9]}),s(n,{type:"primary",onClick:Ne},{default:o(()=>[s(l,null,{default:o(()=>[s(w(rt))]),_:1}),e[10]||(e[10]=f(" 刷新数据 ",-1))]),_:1,__:[10]})])])]),s(Z,{class:"operations-card",shadow:"hover"},{default:o(()=>[s(O,{modelValue:E.value,"onUpdate:modelValue":e[3]||(e[3]=i=>E.value=i),type:"card",class:"operation-tabs"},{default:o(()=>[s(C,{label:"批量添加空闲时间",name:"add"},{default:o(()=>[a("div",Mt,[a("div",xt,[s(h,{model:k,"label-width":"120px",size:"default"},{default:o(()=>[a("div",Bt,[a("div",Ft,[s(l,null,{default:o(()=>[s(w(ge))]),_:1}),e[12]||(e[12]=f(" 选择周范围 ",-1))]),a("div",Nt,[s(be,{year:new Date().getFullYear(),onChange:Ae,"max-height":350},null,8,["year"]),V.value.length>0?(u(),_("div",Ut,[s(d,{type:"info",size:"small"},{default:o(()=>[f(" 已选择 "+c(V.value.length)+" 个周: "+c(Ie()),1)]),_:1})])):L("",!0)])]),a("div",Yt,[a("div",Ot,[s(l,null,{default:o(()=>[s(w(dt))]),_:1}),e[13]||(e[13]=f(" 设置空闲时间 ",-1))]),a("div",Lt,[a("div",jt,[(u(),_(z,null,M(H,(i,m)=>a("div",{key:m,class:K(["weekday-card",{active:k.weekdaySelections[m].enabled}])},[a("div",Pt,[s(v,{modelValue:k.weekdaySelections[m].enabled,"onUpdate:modelValue":r=>k.weekdaySelections[m].enabled=r,onChange:r=>$e(m),size:"large"},{default:o(()=>[a("span",Rt,c(i),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),k.weekdaySelections[m].enabled?(u(),_("div",Gt,[s(W,{modelValue:k.weekdaySelections[m].timeSlotIds,"onUpdate:modelValue":r=>k.weekdaySelections[m].timeSlotIds=r,size:"small"},{default:o(()=>[(u(!0),_(z,null,M(B.value,r=>(u(),_("div",{key:r.id,class:"time-slot-item"},[s(v,{label:r.id},{default:o(()=>[a("div",Ht,[a("div",Kt,c(r.name),1),a("div",Xt,c(r.startTime)+" - "+c(r.endTime),1)])]),_:2},1032,["label"])]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):L("",!0)],2)),64))])])]),a("div",qt,[s(n,{type:"primary",size:"large",onClick:Ee,loading:F.value},{default:o(()=>[s(l,null,{default:o(()=>[s(w(we))]),_:1}),e[14]||(e[14]=f(" 批量添加空闲时间 ",-1))]),_:1,__:[14]},8,["loading"]),s(n,{onClick:ce,size:"large"},{default:o(()=>[s(l,null,{default:o(()=>[s(w(ke))]),_:1}),e[15]||(e[15]=f(" 重置表单 ",-1))]),_:1,__:[15]})])]),_:1},8,["model"])])])]),_:1}),s(C,{label:"批量删除空闲时间",name:"delete"},{default:o(()=>[a("div",Jt,[a("div",Qt,[s(h,{model:D,"label-width":"120px",size:"default"},{default:o(()=>[a("div",Zt,[a("div",ea,[s(l,null,{default:o(()=>[s(w(ge))]),_:1}),e[16]||(e[16]=f(" 选择周范围 ",-1))]),a("div",ta,[s(be,{year:new Date().getFullYear(),onChange:Ve,"max-height":350},null,8,["year"]),$.value.length>0?(u(),_("div",aa,[s(d,{type:"warning",size:"small"},{default:o(()=>[f(" 已选择 "+c($.value.length)+" 个周: "+c(We()),1)]),_:1})])):L("",!0)])]),a("div",sa,[a("div",la,[s(l,null,{default:o(()=>[s(w(ct))]),_:1}),e[17]||(e[17]=f(" 删除条件 ",-1)),e[18]||(e[18]=a("span",{class:"optional-text"},"(可选)",-1))]),a("div",oa,[s(T,{title:"删除规则说明",type:"warning",closable:!1,"show-icon":"",class:"delete-rules"},{default:o(()=>e[19]||(e[19]=[a("ul",null,[a("li",null,"如果不选择任何星期，将删除所选周范围内的所有空闲时间记录"),a("li",null,"如果选择了星期但未选择时间段，将删除该星期的所有时间段"),a("li",null,"如果同时选择了星期和时间段，只删除匹配的特定记录")],-1)])),_:1,__:[19]}),a("div",na,[(u(),_(z,null,M(H,(i,m)=>a("div",{key:m,class:K(["weekday-card",{active:D.weekdaySelections[m].enabled}])},[a("div",ia,[s(v,{modelValue:D.weekdaySelections[m].enabled,"onUpdate:modelValue":r=>D.weekdaySelections[m].enabled=r,onChange:r=>Te(m),size:"large"},{default:o(()=>[a("span",ra,c(i),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),D.weekdaySelections[m].enabled?(u(),_("div",da,[s(W,{modelValue:D.weekdaySelections[m].timeSlotIds,"onUpdate:modelValue":r=>D.weekdaySelections[m].timeSlotIds=r,size:"small"},{default:o(()=>[(u(!0),_(z,null,M(B.value,r=>(u(),_("div",{key:r.id,class:"time-slot-item"},[s(v,{label:r.id},{default:o(()=>[a("div",ca,[a("div",ua,c(r.name),1),a("div",ma,c(r.startTime)+" - "+c(r.endTime),1)])]),_:2},1032,["label"])]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):L("",!0)],2)),64))])])]),a("div",_a,[s(n,{type:"danger",size:"large",onClick:xe,loading:te.value},{default:o(()=>[s(l,null,{default:o(()=>[s(w(he))]),_:1}),e[20]||(e[20]=f(" 批量删除空闲时间 ",-1))]),_:1,__:[20]},8,["loading"]),s(n,{onClick:ue,size:"large"},{default:o(()=>[s(l,null,{default:o(()=>[s(w(ke))]),_:1}),e[21]||(e[21]=f(" 重置表单 ",-1))]),_:1,__:[21]})])]),_:1},8,["model"])])])]),_:1}),s(C,{label:"我的空闲时间",name:"list"},{default:o(()=>[a("div",fa,[a("div",ya,[a("div",va,[a("div",pa,[s(n,{onClick:Pe,icon:w(pe),size:"default"},{default:o(()=>e[22]||(e[22]=[f("上一周",-1)])),_:1,__:[22]},8,["icon"]),a("div",ga,[a("h3",null,c(ae.value||"加载中..."),1),a("div",wa,[a("span",ka,"第"+c(se.value)+"周",1)]),s(n,{onClick:Ge,size:"small",type:"primary",link:""},{default:o(()=>e[23]||(e[23]=[f("回到本周",-1)])),_:1,__:[23]})]),s(n,{onClick:Re,icon:w(ut),size:"default"},{default:o(()=>e[24]||(e[24]=[f("下一周",-1)])),_:1,__:[24]},8,["icon"])]),a("div",ha,[a("div",Da,[s(A,{modelValue:J.value,"onUpdate:modelValue":e[1]||(e[1]=i=>J.value=i),placeholder:"输入周次跳转",size:"small",style:{width:"120px"},onKeyup:ot(_e,["enter"])},{append:o(()=>[s(n,{onClick:_e,size:"small"},{default:o(()=>e[25]||(e[25]=[f("跳转",-1)])),_:1,__:[25]})]),_:1},8,["modelValue"])]),a("div",ba,[a("span",null,"输入周次(1-"+c(G.value)+")快速跳转",1)])])]),nt((u(),_("div",Sa,[a("div",Ca,[a("div",Ia,[e[26]||(e[26]=a("div",{class:"time-cell"},"时间段",-1)),(u(!0),_(z,null,M(P.value,i=>(u(),_("div",{key:i.date,class:K(["day-cell",{today:Le(i.date)}])},[a("div",Wa,c(i.name),1),a("div",Aa,c(Q(i.date)),1)],2))),128))]),(u(!0),_(z,null,M(B.value,i=>(u(),_("div",{key:i.id,class:"time-row"},[a("div",Va,[a("div",$a,c(i.name),1),a("div",Ta,c(i.startTime)+" - "+c(i.endTime),1)]),(u(!0),_(z,null,M(P.value,m=>(u(),_("div",{key:`${i.id}-${m.date}`,class:"availability-cell"},[a("div",{class:K(["availability-status",He(i.id,m.date)])},[a("div",Ea,[a("div",za,[(u(!0),_(z,null,M(ye(i.id,m.date),r=>(u(),_("div",{key:r.id,class:K(["my-availability-item",`priority-${r.priority||1}`])},[a("div",Ma,[a("div",xa,[a("span",Ba,c("★".repeat(r.priority||1)),1),a("span",Fa,"优先级"+c(r.priority||1),1)]),r.notes?(u(),_("div",Na,c(r.notes),1)):L("",!0)]),a("div",Ua,[s(n,{class:"action-btn edit-btn",size:"small",type:"primary",onClick:Ze=>Ke(r),title:"编辑"},{default:o(()=>[s(l,null,{default:o(()=>[s(w(Wt))]),_:1})]),_:2},1032,["onClick"]),s(n,{class:"action-btn delete-btn",size:"small",type:"danger",onClick:Ze=>Ue(r),loading:q.value.includes(r.id),title:"删除"},{default:o(()=>[s(l,null,{default:o(()=>[s(w(he))]),_:1})]),_:2},1032,["onClick","loading"])])],2))),128))])])],2)]))),128))]))),128))])])),[[Qe,X.value]]),!X.value&&j.value.length===0?(u(),it(I,{key:0,description:"本周暂无空闲时间记录","image-size":120},{default:o(()=>[s(n,{type:"primary",onClick:e[2]||(e[2]=i=>E.value="add")},{default:o(()=>[s(l,null,{default:o(()=>[s(w(we))]),_:1}),e[27]||(e[27]=f(" 添加空闲时间 ",-1))]),_:1,__:[27]})]),_:1})):L("",!0)])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(Je,{modelValue:R.value,"onUpdate:modelValue":e[8]||(e[8]=i=>R.value=i),title:"编辑空闲时间",width:"500px"},{footer:o(()=>[s(n,{onClick:e[7]||(e[7]=i=>R.value=!1)},{default:o(()=>e[28]||(e[28]=[f("取消",-1)])),_:1,__:[28]}),s(n,{type:"primary",onClick:Xe,loading:F.value},{default:o(()=>e[29]||(e[29]=[f(" 保存修改 ",-1)])),_:1,__:[29]},8,["loading"])]),default:o(()=>[s(h,{model:p,"label-width":"100px"},{default:o(()=>[s(ie,{label:"日期"},{default:o(()=>[s(ne,{modelValue:p.date,"onUpdate:modelValue":e[4]||(e[4]=i=>p.date=i),type:"date",disabled:"","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),s(ie,{label:"优先级"},{default:o(()=>[s(qe,{modelValue:p.priority,"onUpdate:modelValue":e[5]||(e[5]=i=>p.priority=i),"show-text":""},null,8,["modelValue"])]),_:1}),s(ie,{label:"备注"},{default:o(()=>[s(A,{modelValue:p.notes,"onUpdate:modelValue":e[6]||(e[6]=i=>p.notes=i),type:"textarea",rows:3,placeholder:"可选：添加备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},cs=tt(Ya,[["__scopeId","data-v-ab0bad3a"]]);export{cs as default};
