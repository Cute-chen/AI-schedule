import"./index-bcd0f302.js";/* empty css                *//* empty css                     */import{_ as x}from"./_plugin-vue_export-helper-8da67cfc.js";/* empty css                 */import{aC as R,aB as b,r as g,X as E,k as V,y as c,z as m,A as l,Q as o,I as t,a5 as B,M as F}from"./vendor-b2a91a46.js";import{a as q}from"./utils-88d415ea.js";import{E as n,W as z,X as C,p as I,_ as L,Z as M}from"./elementPlus-9365ac08.js";const N={class:"reset-password-container"},K={class:"reset-password-box"},T={key:0},U={key:1},X={class:"reset-password-footer"},A={__name:"ResetPassword",setup(Q){const p=R(),_=b(),w=g(),d=g(!1),r=E({password:"",confirmPassword:""}),y={password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度至少6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(a,e,s)=>{e!==r.password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}]},f=async()=>{var a,e;try{await w.value.validate();const s=_.query.token;if(!s){n.error("重置链接无效");return}d.value=!0,await q.post("/api/auth/reset-password",{token:s,password:r.password}),n.success("密码重置成功，请使用新密码登录"),p.push("/login")}catch(s){console.error("Reset password failed:",s),(e=(a=s.response)==null?void 0:a.data)!=null&&e.message?n.error(s.response.data.message):n.error("重置失败，请稍后重试")}finally{d.value=!1}},k=()=>{p.push("/login")};return V(()=>{_.query.token||(n.error("重置链接无效或已过期"),p.push("/login"))}),(a,e)=>{const s=z,i=C,v=I,P=L,h=M;return c(),m("div",N,[l("div",K,[e[3]||(e[3]=l("div",{class:"reset-password-header"},[l("h2",{class:"reset-password-title"},"重置密码"),l("p",{class:"reset-password-subtitle"},"请输入您的新密码")],-1)),o(P,{ref_key:"resetPasswordFormRef",ref:w,model:r,rules:y,class:"reset-password-form",onKeyup:B(f,["enter"])},{default:t(()=>[o(i,{prop:"password"},{default:t(()=>[o(s,{modelValue:r.password,"onUpdate:modelValue":e[0]||(e[0]=u=>r.password=u),type:"password",placeholder:"请输入新密码","prefix-icon":"Lock",size:"large","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(i,{prop:"confirmPassword"},{default:t(()=>[o(s,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=u=>r.confirmPassword=u),type:"password",placeholder:"请确认新密码","prefix-icon":"Lock",size:"large","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(i,null,{default:t(()=>[o(v,{loading:d.value,type:"primary",size:"large",class:"reset-password-button",onClick:f},{default:t(()=>[d.value?(c(),m("span",U,"重置中...")):(c(),m("span",T,"重置密码"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),l("div",X,[o(h,{type:"primary",onClick:k},{default:t(()=>e[2]||(e[2]=[F("返回登录",-1)])),_:1,__:[2]})])])])}}},S=x(A,[["__scopeId","data-v-79f5c057"]]);export{S as default};
