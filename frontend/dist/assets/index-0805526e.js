import{c as E}from"./index-bcd0f302.js";/* empty css                    */import{_ as L}from"./_plugin-vue_export-helper-8da67cfc.js";/* empty css                *//* empty css                     *//* empty css                          *//* empty css                    *//* empty css                       *//* empty css                 *//* empty css                     */import{c as ae,ap as Ie,X as se,Y as Ce,af as Te,_ as oe,a2 as ne,p as ie,E as c,k as Ue,av as me,W as _e,ad as De,O as fe,P as ce,aj as qe,M as xe,ak as Pe,a4 as ge,a5 as ve,S as Ne,T as Re,ae as je,ag as Me}from"./elementPlus-9365ac08.js";import{i as re,X as z,k as K,f as de,al as B,y,z as q,Q as e,I as t,A as u,M as p,r as I,P as F,L as H,J as Oe,H as le,O as M,a4 as $e,t as ze}from"./vendor-b2a91a46.js";/* empty css                  *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                        */import"./el-tooltip-4ed993c7.js";/* empty css               *//* empty css                        */import"./utils-88d415ea.js";const Be={class:"general-settings"},Ye={class:"card-header"},Fe={class:"save-section"},He={__name:"GeneralSettings",props:{loading:{type:Boolean,default:!1}},emits:["save"],setup(N,{emit:C}){const g=C,b=re("settings"),n=z({weekStartDate:new Date().toISOString().split("T")[0],workDays:["1","2","3","4","5"]}),r=()=>{const f={system_config:{weekStartDate:n.weekStartDate,workDays:n.workDays}};g("save","general",f)},T=()=>{Object.assign(n,{weekStartDate:new Date().toISOString().split("T")[0],workDays:["1","2","3","4","5"]})},V=()=>{const f=b.value.general;f.system_config&&Object.assign(n,f.system_config)};return K(()=>{V()}),de(()=>b.value.general,f=>{f&&Object.keys(f).length>0&&V()},{deep:!0}),(f,o)=>{const i=B("Calendar"),a=ae,_=Ie,U=se,v=Ce,S=Te,O=oe,R=ne,w=ie;return y(),q("div",Be,[e(R,{class:"settings-card"},{default:t(()=>[e(R,null,{header:t(()=>[u("div",Ye,[e(a,null,{default:t(()=>[e(i)]),_:1}),o[2]||(o[2]=u("span",null,"系统设置",-1))])]),default:t(()=>[e(O,{model:n,"label-width":"120px",ref:"systemFormRef"},{default:t(()=>[e(U,{label:"周起始日期"},{default:t(()=>[e(_,{modelValue:n.weekStartDate,"onUpdate:modelValue":o[0]||(o[0]=k=>n.weekStartDate=k),type:"date",placeholder:"选择第一周开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"]),o[3]||(o[3]=u("div",{class:"form-tip"},"设置排班系统的周起始日期",-1))]),_:1,__:[3]}),e(U,{label:"工作日设置"},{default:t(()=>[e(S,{modelValue:n.workDays,"onUpdate:modelValue":o[1]||(o[1]=k=>n.workDays=k)},{default:t(()=>[e(v,{label:"1"},{default:t(()=>o[4]||(o[4]=[p("周一",-1)])),_:1,__:[4]}),e(v,{label:"2"},{default:t(()=>o[5]||(o[5]=[p("周二",-1)])),_:1,__:[5]}),e(v,{label:"3"},{default:t(()=>o[6]||(o[6]=[p("周三",-1)])),_:1,__:[6]}),e(v,{label:"4"},{default:t(()=>o[7]||(o[7]=[p("周四",-1)])),_:1,__:[7]}),e(v,{label:"5"},{default:t(()=>o[8]||(o[8]=[p("周五",-1)])),_:1,__:[8]}),e(v,{label:"6"},{default:t(()=>o[9]||(o[9]=[p("周六",-1)])),_:1,__:[9]}),e(v,{label:"7"},{default:t(()=>o[10]||(o[10]=[p("周日",-1)])),_:1,__:[10]})]),_:1},8,["modelValue"]),o[11]||(o[11]=u("div",{class:"form-tip"},"选择系统的工作日",-1))]),_:1,__:[11]})]),_:1},8,["model"])]),_:1})]),_:1}),u("div",Fe,[e(w,{type:"primary",size:"large",onClick:r,loading:N.loading},{default:t(()=>o[12]||(o[12]=[p(" 保存基本设置 ",-1)])),_:1,__:[12]},8,["loading"]),e(w,{size:"large",onClick:T},{default:t(()=>o[13]||(o[13]=[p(" 重置 ",-1)])),_:1,__:[13]})])])}}},Le=L(He,[["__scopeId","data-v-21fa2323"]]);const Ke={class:"email-settings"},Ge={class:"card-header"},Xe={class:"card-header"},Je={class:"card-header"},Qe={class:"save-section"},We={class:"form-tip"},Ze={__name:"EmailSettings",props:{loading:{type:Boolean,default:!1}},emits:["save","test"],setup(N,{emit:C}){const g=C,b=re("settings"),n=z({enabled:!1,smtpHost:"",smtpPort:587,smtpUser:"",smtpPassword:"",smtpSsl:!0,fromName:"排班管理系统"}),r=z({aiScheduleNotification:!0,shiftRequest:!0,shiftRequestApproved:!0}),T=I([]),V=I(!1),f=I(!1),o=I(!1),i=I(!1),a=z({id:null,name:"",subject:"",content:"",event_type:"",is_default:!1,is_active:!0}),_={smtpHost:[{required:!0,message:"请输入SMTP服务器",trigger:"blur"}],smtpPort:[{required:!0,message:"请输入SMTP端口",trigger:"blur"}],smtpUser:[{required:!0,message:"请输入发送邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],smtpPassword:[{required:!0,message:"请输入邮箱密码",trigger:"blur"}]},U={name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],event_type:[{required:!0,message:"请选择事件类型",trigger:"blur"}],subject:[{required:!0,message:"请输入邮件主题",trigger:"blur"}],content:[{required:!0,message:"请输入邮件内容",trigger:"blur"}]},v=()=>{g("test",{...n}),f.value=!0,setTimeout(()=>{f.value=!1},3e3)},S=d=>({aiScheduleNotification:"AI排班通知",shiftRequest:"调班申请通知",shiftRequestApproved:"调班成功通知"})[d]||d,O=d=>({aiScheduleNotification:"primary",shiftRequest:"warning",shiftRequestApproved:"success"})[d]||"info",R=d=>({aiScheduleNotification:["employeeName","scheduleCount","scheduleList","generatedTime"],shiftRequest:["requesterName","originalShift","targetShift","reason","requestTime"],shiftRequestApproved:["employeeName","originalShift","newShift","approvalDate","approvalNotes"]})[d]||[],w=async()=>{try{V.value=!0;const d=await E.getEmailTemplates();T.value=d.data}catch(d){console.error("加载邮件模板失败:",d),c.error("加载邮件模板失败")}finally{V.value=!1}},k=()=>{Object.assign(a,{id:null,name:"",subject:"",content:"",event_type:"",is_default:!1,is_active:!0}),o.value=!0},G=d=>{Object.assign(a,d),o.value=!0},X=async()=>{var d,l;try{i.value=!0,console.log("提交的模板数据:",a),a.id?(await E.updateEmailTemplate(a.id,a),c.success("模板更新成功")):(await E.createEmailTemplate(a),c.success("模板创建成功")),o.value=!1,await w()}catch($){console.error("保存模板详细错误:",$),c.error(`保存模板失败: ${((l=(d=$.response)==null?void 0:d.data)==null?void 0:l.message)||$.message}`)}finally{i.value=!1}},J=async d=>{try{await Ue.confirm(`确定要删除模板 "${d.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await E.deleteEmailTemplate(d.id),c.success("模板删除成功"),await w()}catch(l){l!=="cancel"&&(console.error("删除模板失败:",l),c.error("删除模板失败"))}},Q=()=>{g("save","notification",{email_config:n,email_events:r})},A=()=>{Object.assign(n,{enabled:!1,smtpHost:"",smtpPort:587,smtpUser:"",smtpPassword:"",smtpSsl:!0,fromName:"排班管理系统"}),Object.assign(r,{aiScheduleNotification:!0,shiftRequest:!0,shiftRequestApproved:!0})},ue=()=>{const d=b.value.notification;d.email_config&&Object.assign(n,d.email_config),d.email_events&&Object.assign(r,d.email_events)};return K(()=>{ue(),w()}),de(()=>b.value.notification,d=>{d&&Object.keys(d).length>0&&ue()},{deep:!0}),(d,l)=>{const $=B("Message"),W=ae,x=me,m=se,P=_e,be=De,D=ie,Z=oe,h=ne,ee=fe,ye=B("Bell"),pe=ce,Ve=B("Document"),j=qe,Y=xe,Se=Pe,te=ge,we=ve,ke=Ne,Ae=Re;return y(),q("div",Ke,[e(pe,{gutter:20},{default:t(()=>[e(ee,{span:12},{default:t(()=>[e(h,null,{header:t(()=>[u("div",Ge,[e(W,null,{default:t(()=>[e($)]),_:1}),l[18]||(l[18]=u("span",null,"邮件服务配置",-1))])]),default:t(()=>[e(Z,{model:n,"label-width":"120px",ref:"emailFormRef",rules:_},{default:t(()=>[e(m,{label:"启用邮件",required:""},{default:t(()=>[e(x,{modelValue:n.enabled,"onUpdate:modelValue":l[0]||(l[0]=s=>n.enabled=s)},null,8,["modelValue"]),l[19]||(l[19]=u("span",{class:"form-tip"},"开启后会向员工发送排班和调班通知",-1))]),_:1,__:[19]}),n.enabled?(y(),q(F,{key:0},[e(m,{label:"SMTP服务器",prop:"smtpHost",required:""},{default:t(()=>[e(P,{modelValue:n.smtpHost,"onUpdate:modelValue":l[1]||(l[1]=s=>n.smtpHost=s),placeholder:"例如: smtp.qq.com"},null,8,["modelValue"])]),_:1}),e(m,{label:"SMTP端口",prop:"smtpPort",required:""},{default:t(()=>[e(be,{modelValue:n.smtpPort,"onUpdate:modelValue":l[2]||(l[2]=s=>n.smtpPort=s),min:1,max:65535,placeholder:"例如: 587",style:{width:"120px"}},null,8,["modelValue"]),l[20]||(l[20]=u("span",{class:"form-tip"},"常用端口: 25, 465, 587, 993",-1))]),_:1,__:[20]}),e(m,{label:"发送邮箱",prop:"smtpUser",required:""},{default:t(()=>[e(P,{modelValue:n.smtpUser,"onUpdate:modelValue":l[3]||(l[3]=s=>n.smtpUser=s),placeholder:"系统发送邮件的邮箱地址"},null,8,["modelValue"])]),_:1}),e(m,{label:"邮箱密码",prop:"smtpPassword",required:""},{default:t(()=>[e(P,{modelValue:n.smtpPassword,"onUpdate:modelValue":l[4]||(l[4]=s=>n.smtpPassword=s),type:"password","show-password":"",placeholder:"邮箱授权码或密码"},null,8,["modelValue"])]),_:1}),e(m,{label:"发件人名称"},{default:t(()=>[e(P,{modelValue:n.fromName,"onUpdate:modelValue":l[5]||(l[5]=s=>n.fromName=s),placeholder:"邮件发送者显示名称"},null,8,["modelValue"])]),_:1}),e(m,{label:"使用SSL"},{default:t(()=>[e(x,{modelValue:n.smtpSsl,"onUpdate:modelValue":l[6]||(l[6]=s=>n.smtpSsl=s)},null,8,["modelValue"]),l[21]||(l[21]=u("span",{class:"form-tip"},"推荐开启以提高安全性",-1))]),_:1,__:[21]}),e(m,null,{default:t(()=>[e(D,{type:"success",onClick:v,loading:f.value},{default:t(()=>l[22]||(l[22]=[p(" 测试邮件配置 ",-1)])),_:1,__:[22]},8,["loading"]),l[23]||(l[23]=u("span",{class:"form-tip"},"点击测试邮件服务器连接",-1))]),_:1,__:[23]})],64)):H("",!0)]),_:1},8,["model"])]),_:1})]),_:1}),e(ee,{span:12},{default:t(()=>[e(h,null,{header:t(()=>[u("div",Xe,[e(W,null,{default:t(()=>[e(ye)]),_:1}),l[24]||(l[24]=u("span",null,"通知事件配置",-1))])]),default:t(()=>[e(Z,{model:r,"label-width":"140px"},{default:t(()=>[e(m,{label:"AI排班通知"},{default:t(()=>[e(x,{modelValue:r.aiScheduleNotification,"onUpdate:modelValue":l[7]||(l[7]=s=>r.aiScheduleNotification=s)},null,8,["modelValue"]),l[25]||(l[25]=u("span",{class:"form-tip"},"AI生成排班后通知相关员工",-1))]),_:1,__:[25]}),e(m,{label:"调班申请通知"},{default:t(()=>[e(x,{modelValue:r.shiftRequest,"onUpdate:modelValue":l[8]||(l[8]=s=>r.shiftRequest=s)},null,8,["modelValue"]),l[26]||(l[26]=u("span",{class:"form-tip"},"有新的调班申请时通知管理员",-1))]),_:1,__:[26]}),e(m,{label:"调班成功通知"},{default:t(()=>[e(x,{modelValue:r.shiftRequestApproved,"onUpdate:modelValue":l[9]||(l[9]=s=>r.shiftRequestApproved=s)},null,8,["modelValue"]),l[27]||(l[27]=u("span",{class:"form-tip"},"调班申请被批准时通知申请人和受影响的员工",-1))]),_:1,__:[27]})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),e(pe,{gutter:20,style:{"margin-top":"20px"}},{default:t(()=>[e(ee,{span:24},{default:t(()=>[e(h,null,{header:t(()=>[u("div",Je,[e(W,null,{default:t(()=>[e(Ve)]),_:1}),l[29]||(l[29]=u("span",null,"邮件模板管理",-1)),e(D,{type:"primary",size:"small",onClick:k,style:{"margin-left":"auto"}},{default:t(()=>l[28]||(l[28]=[p(" 创建模板 ",-1)])),_:1,__:[28]})])]),default:t(()=>[Oe((y(),le(Se,{data:T.value,style:{width:"100%"}},{default:t(()=>[e(j,{prop:"name",label:"模板名称",width:"150"}),e(j,{prop:"event_type",label:"事件类型",width:"120"},{default:t(({row:s})=>[e(Y,{type:O(s.event_type)},{default:t(()=>[p(M(S(s.event_type)),1)]),_:2},1032,["type"])]),_:1}),e(j,{prop:"subject",label:"邮件主题"}),e(j,{prop:"is_default",label:"默认",width:"80"},{default:t(({row:s})=>[s.is_default?(y(),le(Y,{key:0,type:"success",size:"small"},{default:t(()=>l[30]||(l[30]=[p("默认",-1)])),_:1,__:[30]})):H("",!0)]),_:1}),e(j,{prop:"is_active",label:"状态",width:"80"},{default:t(({row:s})=>[e(Y,{type:s.is_active?"success":"danger",size:"small"},{default:t(()=>[p(M(s.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(j,{label:"操作",width:"180"},{default:t(({row:s})=>[e(D,{type:"primary",size:"small",onClick:Ee=>G(s)},{default:t(()=>l[31]||(l[31]=[p(" 编辑 ",-1)])),_:2,__:[31]},1032,["onClick"]),e(D,{type:"danger",size:"small",onClick:Ee=>J(s),disabled:s.is_default},{default:t(()=>l[32]||(l[32]=[p(" 删除 ",-1)])),_:2,__:[32]},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[Ae,V.value]])]),_:1})]),_:1})]),_:1}),u("div",Qe,[e(D,{type:"primary",size:"large",onClick:Q,loading:N.loading},{default:t(()=>l[33]||(l[33]=[p(" 保存通知设置 ",-1)])),_:1,__:[33]},8,["loading"]),e(D,{size:"large",onClick:A},{default:t(()=>l[34]||(l[34]=[p(" 重置 ",-1)])),_:1,__:[34]})]),e(ke,{modelValue:o.value,"onUpdate:modelValue":l[17]||(l[17]=s=>o.value=s),title:a.id?"编辑邮件模板":"创建邮件模板",width:"60%","close-on-click-modal":!1},{footer:t(()=>[e(D,{onClick:l[16]||(l[16]=s=>o.value=!1)},{default:t(()=>l[35]||(l[35]=[p("取消",-1)])),_:1,__:[35]}),e(D,{type:"primary",onClick:X,loading:i.value},{default:t(()=>[p(M(a.id?"更新":"创建"),1)]),_:1},8,["loading"])]),default:t(()=>[e(Z,{model:a,"label-width":"100px",ref:"templateFormRef",rules:U},{default:t(()=>[e(m,{label:"模板名称",prop:"name"},{default:t(()=>[e(P,{modelValue:a.name,"onUpdate:modelValue":l[10]||(l[10]=s=>a.name=s),placeholder:"请输入模板名称"},null,8,["modelValue"])]),_:1}),e(m,{label:"事件类型",prop:"event_type"},{default:t(()=>[e(we,{modelValue:a.event_type,"onUpdate:modelValue":l[11]||(l[11]=s=>a.event_type=s),placeholder:"选择事件类型",style:{width:"100%"}},{default:t(()=>[e(te,{label:"AI排班通知",value:"aiScheduleNotification"}),e(te,{label:"调班申请通知",value:"shiftRequest"}),e(te,{label:"调班成功通知",value:"shiftRequestApproved"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"邮件主题",prop:"subject"},{default:t(()=>[e(P,{modelValue:a.subject,"onUpdate:modelValue":l[12]||(l[12]=s=>a.subject=s),placeholder:"请输入邮件主题"},null,8,["modelValue"]),u("div",We,"可使用变量: "+M(d.employeeName)+", "+M(d.date)+" 等",1)]),_:1}),e(m,{label:"邮件内容",prop:"content"},{default:t(()=>[e(P,{modelValue:a.content,"onUpdate:modelValue":l[13]||(l[13]=s=>a.content=s),type:"textarea",rows:8,placeholder:"请输入邮件内容，支持HTML格式"},null,8,["modelValue"])]),_:1}),e(m,{label:"可用变量"},{default:t(()=>[(y(!0),q(F,null,$e(R(a.event_type),s=>(y(),le(Y,{key:s,type:"info",size:"small",style:{margin:"2px"}},{default:t(()=>[p(M("{{"+s+"}}"),1)]),_:2},1024))),128))]),_:1}),e(m,{label:"设为默认"},{default:t(()=>[e(x,{modelValue:a.is_default,"onUpdate:modelValue":l[14]||(l[14]=s=>a.is_default=s)},null,8,["modelValue"])]),_:1}),e(m,{label:"启用模板"},{default:t(()=>[e(x,{modelValue:a.is_active,"onUpdate:modelValue":l[15]||(l[15]=s=>a.is_active=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},he=L(Ze,[["__scopeId","data-v-6af06275"]]);const et={class:"ai-settings"},tt={class:"card-header"},lt={class:"save-section"},at={__name:"AISettings",props:{loading:{type:Boolean,default:!1}},emits:["save","test"],setup(N,{emit:C}){const g=C,b=re("settings"),n=I(!1),r=z({enabled:!1,provider:"deepseek",config:{deepseek:{apiUrl:"",apiKey:""}}}),T=async()=>{const i=r.provider,a=r.config[i];if(!a.apiKey){c.error("请先输入API Key");return}n.value=!0;try{g("test",i,a)}finally{n.value=!1}},V=()=>{const i={ai_config:{enabled:r.enabled,provider:r.provider,config:r.config}};g("save","ai",i)},f=()=>{Object.assign(r,{enabled:!1,provider:"deepseek",config:{deepseek:{apiUrl:"",apiKey:""}}})},o=()=>{const i=b.value.ai;i.ai_config&&Object.assign(r,i.ai_config)};return K(()=>{o()}),de(()=>b.value.ai,i=>{i&&Object.keys(i).length>0&&o()},{deep:!0}),(i,a)=>{const _=B("Cpu"),U=ae,v=me,S=se,O=ge,R=ve,w=_e,k=ie,G=oe,X=ne,J=fe,Q=ce;return y(),q("div",et,[e(Q,{gutter:20},{default:t(()=>[e(J,{span:24},{default:t(()=>[e(X,null,{header:t(()=>[u("div",tt,[e(U,null,{default:t(()=>[e(_)]),_:1}),a[4]||(a[4]=u("span",null,"AI服务配置",-1))])]),default:t(()=>[e(G,{model:r,"label-width":"120px",ref:"aiFormRef"},{default:t(()=>[e(S,{label:"启用AI排班"},{default:t(()=>[e(v,{modelValue:r.enabled,"onUpdate:modelValue":a[0]||(a[0]=A=>r.enabled=A)},null,8,["modelValue"]),a[5]||(a[5]=u("span",{class:"form-tip"},"使用AI自动生成排班方案",-1))]),_:1,__:[5]}),r.enabled?(y(),q(F,{key:0},[e(S,{label:"AI提供商"},{default:t(()=>[e(R,{modelValue:r.provider,"onUpdate:modelValue":a[1]||(a[1]=A=>r.provider=A),placeholder:"选择AI提供商",style:{width:"300px"}},{default:t(()=>[e(O,{label:"DeepSeek (推荐)",value:"deepseek"})]),_:1},8,["modelValue"])]),_:1}),r.provider==="deepseek"?(y(),q(F,{key:0},[e(S,{label:"API URL"},{default:t(()=>[e(w,{modelValue:r.config.deepseek.apiUrl,"onUpdate:modelValue":a[2]||(a[2]=A=>r.config.deepseek.apiUrl=A),placeholder:"https://api.deepseek.com/v1/chat/completions",style:{width:"400px"}},null,8,["modelValue"]),a[6]||(a[6]=u("div",{class:"form-tip"},"DeepSeek API 接口地址，可自定义或使用默认地址",-1))]),_:1,__:[6]}),e(S,{label:"API Key"},{default:t(()=>[e(w,{modelValue:r.config.deepseek.apiKey,"onUpdate:modelValue":a[3]||(a[3]=A=>r.config.deepseek.apiKey=A),type:"password","show-password":"",placeholder:"sk-...",style:{width:"400px"}},null,8,["modelValue"]),a[7]||(a[7]=u("div",{class:"form-tip"},"在DeepSeek平台获取API密钥",-1))]),_:1,__:[7]})],64)):H("",!0),e(S,null,{default:t(()=>[e(k,{type:"success",onClick:T,loading:n.value},{default:t(()=>a[8]||(a[8]=[p(" 测试AI连接 ",-1)])),_:1,__:[8]},8,["loading"]),a[9]||(a[9]=u("span",{class:"form-tip"},"点击测试AI服务连接是否正常",-1))]),_:1,__:[9]})],64)):H("",!0)]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),u("div",lt,[e(k,{type:"primary",size:"large",onClick:V,loading:N.loading},{default:t(()=>a[10]||(a[10]=[p(" 保存AI设置 ",-1)])),_:1,__:[10]},8,["loading"]),e(k,{size:"large",onClick:f},{default:t(()=>a[11]||(a[11]=[p(" 重置 ",-1)])),_:1,__:[11]})])])}}},st=L(at,[["__scopeId","data-v-dbe13a13"]]);const ot={class:"settings-container"},nt={__name:"index",setup(N){const C=I("general"),g=I(!1),b=I({general:{},notification:{},ai:{}});ze("settings",b);const n=async(i,a)=>{try{g.value=!0,await E.updateSettings(i,a),await r(i),c.success(`${f(i)}设置已保存`)}catch(_){console.error("保存设置失败:",_),c.error("保存失败，请重试")}finally{g.value=!1}},r=async i=>{try{const a=await E.getSettingsByCategory(i);b.value[i]=a.data}catch(a){console.error(`加载${i}设置失败:`,a)}},T=async i=>{try{const a=await E.testEmail(i);a.success?c.success(a.message):c.error(a.message)}catch(a){console.error("邮件测试失败:",a),c.error("邮件测试失败，请检查配置")}},V=async(i,a)=>{try{const _=await E.testAIConnection(i,a);_.success?c.success(_.message):c.error(_.message)}catch(_){console.error("AI测试失败:",_),c.error("AI连接测试失败，请检查配置")}},f=i=>({general:"基本",notification:"通知",ai:"AI"})[i]||i,o=async()=>{try{const i=await E.getSettings();b.value=i.data}catch(i){console.error("加载设置失败:",i),c.error("加载设置失败")}};return K(()=>{o()}),(i,a)=>{const _=je,U=Me;return y(),q("div",ot,[a[1]||(a[1]=u("div",{class:"page-header"},[u("h1",null,"系统设置"),u("p",null,"配置系统参数、邮件通知和AI服务")],-1)),e(U,{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=v=>C.value=v),type:"border-card",class:"settings-tabs"},{default:t(()=>[e(_,{label:"基本设置",name:"general",lazy:""},{default:t(()=>[e(Le,{onSave:n,loading:g.value},null,8,["loading"])]),_:1}),e(_,{label:"通知设置",name:"notification",lazy:""},{default:t(()=>[e(he,{onSave:n,onTest:T,loading:g.value},null,8,["loading"])]),_:1}),e(_,{label:"AI设置",name:"ai",lazy:""},{default:t(()=>[e(st,{onSave:n,onTest:V,loading:g.value},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"])])}}},Tt=L(nt,[["__scopeId","data-v-f3747f5d"]]);export{Tt as default};
