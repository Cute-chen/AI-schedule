import{u as N,w as F}from"./index-bcd0f302.js";/* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                     *//* empty css               *//* empty css               *//* empty css                *//* empty css                     */import{_ as q}from"./_plugin-vue_export-helper-8da67cfc.js";import{W as z}from"./WeekRangeSelector-08a2a9b6.js";import{E as f,a2 as A,X as O,p as P,_ as U,O as X,P as j,aj as L,M as Q,ak as G,a3 as J}from"./elementPlus-9365ac08.js";import{r as W,X as K,k as Y,y as m,z as w,A as o,Q as e,I as s,H as x,L as k,M as c,O as u}from"./vendor-b2a91a46.js";import"./utils-88d415ea.js";/* empty css                 *//* empty css                        */import"./settingsService-87306db1.js";const Z={class:"work-hours-statistics"},$={class:"summary-section"},tt={class:"summary-item"},et={class:"summary-value"},st={class:"summary-item"},at={class:"summary-value"},ot={class:"summary-item"},lt={class:"summary-value"},rt={class:"summary-item"},it={class:"summary-value"},nt={key:0,class:"weekly-section"},ut={key:1,class:"daily-section"},dt={__name:"WorkHoursStatistics",setup(mt){const R=N(),_=W(!1),r=W(null),d=K({weekRange:[1,4]}),g=async()=>{var i;if(d.weekRange.length===0){f.warning("请选择周期范围");return}_.value=!0;try{const t={employeeId:(i=R.userInfo)==null?void 0:i.id,startWeek:Math.min(...d.weekRange),endWeek:Math.max(...d.weekRange)};console.log("查询个人工时参数:",t);const l=await F.getEmployeeWorkHours(t);l.success&&l.data?(r.value=l.data,console.log("个人工时数据:",l.data),f.success("个人工时数据查询成功")):f.error(l.message||"查询个人工时数据失败")}catch(t){console.error("查询个人工时数据失败:",t),f.error("查询个人工时数据失败")}finally{_.value=!1}},M=i=>{var t,l;return(l=(t=r.value)==null?void 0:t.statistics)!=null&&l.totalHours?Math.round(i/r.value.statistics.totalHours*100):0},V=i=>{const t=["日","一","二","三","四","五","六"],l=new Date(i);return"周"+t[l.getDay()]},C=i=>i>=8?"success":i>=4?"warning":"info";return Y(()=>{g()}),(i,t)=>{const l=O,D=P,T=U,v=A,p=X,B=j,n=L,h=Q,b=G,I=J;return m(),w("div",Z,[t[9]||(t[9]=o("div",{class:"page-header"},[o("h1",null,"⏰ 我的工时统计"),o("p",null,"查看您的工作时长记录")],-1)),e(v,{class:"filter-section"},{default:s(()=>[e(T,{model:d,inline:""},{default:s(()=>[e(l,{label:"周期范围"},{default:s(()=>[e(z,{modelValue:d.weekRange,"onUpdate:modelValue":t[0]||(t[0]=y=>d.weekRange=y),"max-weeks":52},null,8,["modelValue"])]),_:1}),e(l,null,{default:s(()=>[e(D,{type:"primary",onClick:g,loading:_.value},{default:s(()=>t[1]||(t[1]=[c(" 查询 ",-1)])),_:1,__:[1]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),r.value?(m(),x(v,{key:0,class:"data-section"},{header:s(()=>t[2]||(t[2]=[o("span",null,"工时统计结果",-1)])),default:s(()=>{var y,E,H,S;return[o("div",$,[e(B,{gutter:16},{default:s(()=>[e(p,{span:6},{default:s(()=>{var a;return[o("div",tt,[t[3]||(t[3]=o("div",{class:"summary-label"},"总工时",-1)),o("div",et,u(((a=r.value.statistics)==null?void 0:a.totalHours)||0)+"h",1)])]}),_:1}),e(p,{span:6},{default:s(()=>{var a;return[o("div",st,[t[4]||(t[4]=o("div",{class:"summary-label"},"工作天数",-1)),o("div",at,u(((a=r.value.statistics)==null?void 0:a.workDays)||0)+"天",1)])]}),_:1}),e(p,{span:6},{default:s(()=>{var a;return[o("div",ot,[t[5]||(t[5]=o("div",{class:"summary-label"},"总班次",-1)),o("div",lt,u(((a=r.value.statistics)==null?void 0:a.totalShifts)||0)+"次",1)])]}),_:1}),e(p,{span:6},{default:s(()=>{var a;return[o("div",rt,[t[6]||(t[6]=o("div",{class:"summary-label"},"日均工时",-1)),o("div",it,u(((a=r.value.statistics)==null?void 0:a.averageDailyHours)||0)+"h",1)])]}),_:1})]),_:1})]),((E=(y=r.value.statistics)==null?void 0:y.weeklyStats)==null?void 0:E.length)>0?(m(),w("div",nt,[t[7]||(t[7]=o("h3",null,"按周统计",-1)),e(b,{data:r.value.statistics.weeklyStats,stripe:""},{default:s(()=>[e(n,{prop:"week",label:"周数",width:"80"}),e(n,{prop:"hours",label:"工时",width:"100"},{default:s(a=>[e(h,{type:"primary"},{default:s(()=>[c(u(a.row.hours)+"h",1)]),_:2},1024)]),_:1}),e(n,{prop:"shifts",label:"班次",width:"80"}),e(n,{label:"占比",width:"100"},{default:s(a=>[c(u(M(a.row.hours))+"% ",1)]),_:1})]),_:1},8,["data"])])):k("",!0),((S=(H=r.value.statistics)==null?void 0:H.dailyStats)==null?void 0:S.length)>0?(m(),w("div",ut,[t[8]||(t[8]=o("h3",null,"按日统计",-1)),e(b,{data:r.value.statistics.dailyStats,stripe:""},{default:s(()=>[e(n,{prop:"date",label:"日期",width:"120"}),e(n,{label:"星期",width:"80"},{default:s(a=>[c(u(V(a.row.date)),1)]),_:1}),e(n,{prop:"hours",label:"工时",width:"100"},{default:s(a=>[e(h,{type:C(a.row.hours),size:"small"},{default:s(()=>[c(u(a.row.hours)+"h ",1)]),_:2},1032,["type"])]),_:1}),e(n,{prop:"shifts",label:"班次",width:"80"})]),_:1},8,["data"])])):k("",!0)]}),_:1})):_.value?k("",!0):(m(),x(v,{key:1,class:"data-section"},{default:s(()=>[e(I,{description:"暂无工时数据，请先查询"})]),_:1}))])}}},Vt=q(dt,[["__scopeId","data-v-f94dc03d"]]);export{Vt as default};
