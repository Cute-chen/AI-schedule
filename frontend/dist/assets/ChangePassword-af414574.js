import{u as E,r as k}from"./index-bcd0f302.js";/* empty css                *//* empty css                     */import{_ as B}from"./_plugin-vue_export-helper-8da67cfc.js";/* empty css                 */import{aC as z,r as h,X as N,c as q,y as L,z as S,Q as a,I as t,A as o,V as I,u as p,C as m,M as P,O as M}from"./vendor-b2a91a46.js";import{l as w,E as f,k as T,W as U,X as R,p as A,_ as D,a2 as F}from"./elementPlus-9365ac08.js";import"./utils-88d415ea.js";const X={class:"change-password-container"},O={class:"password-tips"},Q={class:"form-actions"},W={__name:"ChangePassword",setup(Z){const _=z(),y=E(),c=h(),u=h(!1),r=N({currentPassword:"",newPassword:"",confirmPassword:""}),l=q(()=>({minLength:r.newPassword.length>=8,hasNumber:/\d/.test(r.newPassword),hasLetter:/[a-zA-Z]/.test(r.newPassword)})),x={currentPassword:[{required:!0,message:"è¯·è¾“å…¥å½“å‰å¯†ç ",trigger:"blur"}],newPassword:[{required:!0,message:"è¯·è¾“å…¥æ–°å¯†ç ",trigger:"blur"},{min:8,message:"å¯†ç é•¿åº¦ä¸èƒ½å°‘äº8ä½",trigger:"blur"},{validator:(n,e,s)=>{!l.value.hasNumber||!l.value.hasLetter?s(new Error("å¯†ç å¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—")):s()},trigger:"blur"}],confirmPassword:[{required:!0,message:"è¯·ç¡®è®¤æ–°å¯†ç ",trigger:"blur"},{validator:(n,e,s)=>{e!==r.newPassword?s(new Error("ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´")):s()},trigger:"blur"}]},g=async()=>{var n,e;if(c.value)try{await c.value.validate(),u.value=!0;const s={currentPassword:r.currentPassword,newPassword:r.newPassword};await k.post("/auth/change-password",s),f.success("å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•"),setTimeout(async()=>{await y.logout(),_.push("/login")},1500)}catch(s){console.error("ä¿®æ”¹å¯†ç å¤±è´¥:",s),(e=(n=s.response)==null?void 0:n.data)!=null&&e.message?f.error(s.response.data.message):f.error("å¯†ç ä¿®æ”¹å¤±è´¥ï¼Œè¯·æ£€æŸ¥å½“å‰å¯†ç æ˜¯å¦æ­£ç¡®")}finally{u.value=!1}},b=async()=>{try{await T.confirm("ç¡®å®šè¦å–æ¶ˆä¿®æ”¹å¯†ç å—ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"ç»§ç»­ä¿®æ”¹",type:"warning"}),_.back()}catch{}};return(n,e)=>{const s=U,i=R,v=A,V=D,C=F;return L(),S("div",X,[a(C,{class:"change-password-card"},{header:t(()=>e[3]||(e[3]=[o("div",{class:"card-header"},[o("h2",null,"ğŸ” ä¿®æ”¹å¯†ç "),o("p",null,"ä¸ºäº†è´¦æˆ·å®‰å…¨ï¼Œè¯·å®šæœŸä¿®æ”¹å¯†ç ")],-1)])),default:t(()=>[a(V,{ref_key:"formRef",ref:c,model:r,rules:x,"label-width":"100px",size:"large",onSubmit:I(g,["prevent"])},{default:t(()=>[a(i,{label:"å½“å‰å¯†ç ",prop:"currentPassword"},{default:t(()=>[a(s,{modelValue:r.currentPassword,"onUpdate:modelValue":e[0]||(e[0]=d=>r.currentPassword=d),type:"password",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ","show-password":"","prefix-icon":p(w)},null,8,["modelValue","prefix-icon"])]),_:1}),a(i,{label:"æ–°å¯†ç ",prop:"newPassword"},{default:t(()=>[a(s,{modelValue:r.newPassword,"onUpdate:modelValue":e[1]||(e[1]=d=>r.newPassword=d),type:"password",placeholder:"è¯·è¾“å…¥æ–°å¯†ç ","show-password":"","prefix-icon":p(w)},null,8,["modelValue","prefix-icon"]),o("div",O,[e[4]||(e[4]=o("p",null,"å¯†ç è¦æ±‚ï¼š",-1)),o("ul",null,[o("li",{class:m({valid:l.value.minLength})},"è‡³å°‘8ä¸ªå­—ç¬¦",2),o("li",{class:m({valid:l.value.hasNumber})},"åŒ…å«æ•°å­—",2),o("li",{class:m({valid:l.value.hasLetter})},"åŒ…å«å­—æ¯",2)])])]),_:1}),a(i,{label:"ç¡®è®¤å¯†ç ",prop:"confirmPassword"},{default:t(()=>[a(s,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=d=>r.confirmPassword=d),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç ","show-password":"","prefix-icon":p(w)},null,8,["modelValue","prefix-icon"])]),_:1}),a(i,null,{default:t(()=>[o("div",Q,[a(v,{onClick:b,size:"large"},{default:t(()=>e[5]||(e[5]=[P(" å–æ¶ˆ ",-1)])),_:1,__:[5]}),a(v,{type:"primary",loading:u.value,onClick:g,size:"large"},{default:t(()=>[P(M(u.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})])}}},se=B(W,[["__scopeId","data-v-44dcc487"]]);export{se as default};
