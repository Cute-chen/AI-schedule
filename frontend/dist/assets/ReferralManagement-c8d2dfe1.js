import{u as q,e as H}from"./index-bcd0f302.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                 *//* empty css                 *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                     *//* empty css               *//* empty css                             *//* empty css               *//* empty css                */import{_ as K}from"./_plugin-vue_export-helper-8da67cfc.js";import{E as w,p as X,a2 as Y,P as Z,S as ee,F as te,as as le,G as ae,am as se,c as oe,O as ne,Q as re,R as ie,aj as ue,M as de,an as ce,ak as pe,a3 as _e,a8 as me,W as fe,N as ve,T as ye}from"./elementPlus-9365ac08.js";import{r as v,c as A,k as ge,y as _,z as m,A as a,Q as t,I as l,M as o,O as r,u as k,J as be,L}from"./vendor-b2a91a46.js";import"./utils-88d415ea.js";const Ee={class:"employee-referral-container"},we={class:"page-header"},ke={class:"stat-content"},Ce={class:"stat-number"},xe={class:"stat-icon"},he={class:"stat-content"},De={class:"stat-number"},Te={class:"stat-icon success"},Ve={class:"stat-content"},Re={class:"stat-number"},Ie={class:"stat-icon warning"},Me={class:"card-header"},Se={key:0,class:"referrer-section"},ze={class:"referred-section"},Ne={key:0},Ae={key:1,class:"empty-state"},Le={class:"invite-content"},Ue={class:"invite-help"},$e={class:"invite-link-section"},Be={class:"invite-email-section"},je={key:0},Oe={__name:"ReferralManagement",setup(Pe){const U=q(),y=v(!1),f=v(!1),C=v(!1),u=v(null),i=v({employee:null,referrer:null,referredEmployees:[],referredCount:0}),D=A(()=>{var s;return((s=U.userInfo)==null?void 0:s.email)||""}),x=A(()=>`${window.location.origin}/register`),$=()=>i.value.referredEmployees?i.value.referredEmployees.filter(s=>s.registration_status==="approved").length:0,B=()=>i.value.referredEmployees?i.value.referredEmployees.filter(s=>s.registration_status==="pending").length:0,T=s=>{switch(s){case"approved":return"success";case"pending":return"warning";case"rejected":return"danger";default:return""}},V=s=>{switch(s){case"approved":return"已通过";case"pending":return"审核中";case"rejected":return"已拒绝";default:return"未知"}},R=s=>new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),I=async()=>{try{y.value=!0;const s=await H.getMyReferrals();i.value=s.data||{employee:null,referrer:null,referredEmployees:[],referredCount:0}}catch(s){console.error("获取推荐信息失败:",s),w.error("获取推荐信息失败")}finally{y.value=!1}},M=async()=>{try{await navigator.clipboard.writeText(x.value),w.success("邀请链接已复制到剪贴板")}catch(s){console.error("复制失败:",s);const e=document.createElement("textarea");e.value=x.value,document.body.appendChild(e),e.select();try{document.execCommand("copy"),w.success("邀请链接已复制到剪贴板")}catch{w.error("复制失败，请手动复制链接")}document.body.removeChild(e)}},j=s=>{u.value=s,C.value=!0};return ge(()=>{I()}),(s,e)=>{const d=X,g=oe,b=Y,h=ne,O=Z,c=re,S=ie,p=ue,E=de,P=ce,Q=pe,F=_e,G=me,z=fe,J=ve,N=ee,W=ye;return _(),m("div",Ee,[a("div",we,[e[6]||(e[6]=a("div",null,[a("h1",null,"我的推荐"),a("p",null,"查看您推荐的员工和推荐记录")],-1)),t(d,{type:"primary",onClick:e[0]||(e[0]=n=>f.value=!0),icon:"Share",size:"large"},{default:l(()=>e[5]||(e[5]=[o(" 邀请同事加入 ",-1)])),_:1,__:[5]})]),t(O,{gutter:20,class:"stats-row"},{default:l(()=>[t(h,{span:8},{default:l(()=>[t(b,{class:"stat-card"},{default:l(()=>[a("div",ke,[a("div",Ce,r(i.value.referredCount||0),1),e[7]||(e[7]=a("div",{class:"stat-label"},"已推荐人数",-1))]),a("div",xe,[t(g,null,{default:l(()=>[t(k(te))]),_:1})])]),_:1})]),_:1}),t(h,{span:8},{default:l(()=>[t(b,{class:"stat-card"},{default:l(()=>[a("div",he,[a("div",De,r($()),1),e[8]||(e[8]=a("div",{class:"stat-label"},"已通过审核",-1))]),a("div",Te,[t(g,null,{default:l(()=>[t(k(le))]),_:1})])]),_:1})]),_:1}),t(h,{span:8},{default:l(()=>[t(b,{class:"stat-card"},{default:l(()=>[a("div",Ve,[a("div",Re,r(B()),1),e[9]||(e[9]=a("div",{class:"stat-label"},"审核中",-1))]),a("div",Ie,[t(g,null,{default:l(()=>[t(k(ae))]),_:1})])]),_:1})]),_:1})]),_:1}),t(b,{class:"referral-info-card"},{header:l(()=>[a("div",Me,[e[10]||(e[10]=a("span",null,"推荐详情",-1)),t(d,{onClick:I,loading:y.value,icon:"Refresh",circle:""},null,8,["loading"])])]),default:l(()=>[be((_(),m("div",null,[i.value.referrer?(_(),m("div",Se,[e[11]||(e[11]=a("h3",null,"推荐人信息",-1)),t(S,{column:2,border:""},{default:l(()=>[t(c,{label:"推荐人"},{default:l(()=>[o(r(i.value.referrer.name),1)]),_:1}),t(c,{label:"邮箱"},{default:l(()=>[o(r(i.value.referrer.email),1)]),_:1})]),_:1})])):L("",!0),a("div",ze,[e[13]||(e[13]=a("h3",null,"我推荐的员工",-1)),i.value.referredEmployees&&i.value.referredEmployees.length>0?(_(),m("div",Ne,[t(Q,{data:i.value.referredEmployees,style:{width:"100%"}},{default:l(()=>[t(p,{prop:"name",label:"姓名",width:"150"}),t(p,{prop:"email",label:"邮箱",width:"200"}),t(p,{label:"状态",width:"120"},{default:l(({row:n})=>[t(E,{type:T(n.registration_status)},{default:l(()=>[o(r(V(n.registration_status)),1)]),_:2},1032,["type"])]),_:1}),t(p,{label:"账户状态",width:"120"},{default:l(({row:n})=>[t(E,{type:n.status==="active"?"success":"warning"},{default:l(()=>[o(r(n.status==="active"?"激活":"未激活"),1)]),_:2},1032,["type"])]),_:1}),t(p,{prop:"created_at",label:"注册时间",width:"160"},{default:l(({row:n})=>[o(r(R(n.created_at)),1)]),_:1}),t(p,{label:"操作",width:"100"},{default:l(({row:n})=>[t(P,{content:"查看详情",placement:"top"},{default:l(()=>[t(d,{type:"primary",size:"small",icon:"View",circle:"",onClick:Qe=>j(n)},null,8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])])):(_(),m("div",Ae,[t(F,{description:"您还没有推荐过任何员工","image-size":100},{default:l(()=>[t(d,{type:"primary",onClick:e[1]||(e[1]=n=>f.value=!0)},{default:l(()=>e[12]||(e[12]=[o(" 立即推荐 ",-1)])),_:1,__:[12]})]),_:1})]))])])),[[W,y.value]])]),_:1}),t(N,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=n=>f.value=n),title:"邀请同事加入",width:"600px"},{footer:l(()=>[t(d,{onClick:e[2]||(e[2]=n=>f.value=!1)},{default:l(()=>e[23]||(e[23]=[o("关闭",-1)])),_:1,__:[23]}),t(d,{type:"primary",onClick:M},{default:l(()=>e[24]||(e[24]=[o(" 复制邀请链接 ",-1)])),_:1,__:[24]})]),default:l(()=>[a("div",Le,[t(G,{title:"邀请说明",type:"info",closable:!1,"show-icon":""},{default:l(()=>[a("div",Ue,[e[18]||(e[18]=a("p",null,[a("strong",null,"如何邀请同事：")],-1)),a("ol",null,[e[15]||(e[15]=a("li",null,"将下面的注册链接发送给您的同事",-1)),e[16]||(e[16]=a("li",null,"同事访问链接并填写注册信息",-1)),a("li",null,[e[14]||(e[14]=o("在推荐人邮箱处填写您的邮箱：",-1)),a("strong",null,r(D.value),1)]),e[17]||(e[17]=a("li",null,"提交后等待管理员审核",-1))])])]),_:1}),a("div",$e,[e[20]||(e[20]=a("label",{class:"invite-label"},"注册链接：",-1)),t(z,{value:x.value,readonly:"",class:"invite-input"},{append:l(()=>[t(d,{onClick:M,type:"primary"},{default:l(()=>[t(g,null,{default:l(()=>[t(k(se))]),_:1}),e[19]||(e[19]=o(" 复制 ",-1))]),_:1,__:[19]})]),_:1},8,["value"])]),a("div",Be,[e[22]||(e[22]=a("label",{class:"invite-label"},"您的邮箱（推荐人邮箱）：",-1)),t(z,{value:D.value,readonly:""},null,8,["value"]),t(J,{size:"small",type:"info"},{default:l(()=>e[21]||(e[21]=[o(" 同事在注册时需要填写此邮箱作为推荐人 ",-1)])),_:1,__:[21]})])])]),_:1},8,["modelValue"]),t(N,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=n=>C.value=n),title:"推荐员工详情",width:"500px"},{default:l(()=>[u.value?(_(),m("div",je,[t(S,{column:1,border:""},{default:l(()=>[t(c,{label:"姓名"},{default:l(()=>[o(r(u.value.name),1)]),_:1}),t(c,{label:"邮箱"},{default:l(()=>[o(r(u.value.email),1)]),_:1}),t(c,{label:"注册状态"},{default:l(()=>[t(E,{type:T(u.value.registration_status)},{default:l(()=>[o(r(V(u.value.registration_status)),1)]),_:1},8,["type"])]),_:1}),t(c,{label:"账户状态"},{default:l(()=>[t(E,{type:u.value.status==="active"?"success":"warning"},{default:l(()=>[o(r(u.value.status==="active"?"已激活":"未激活"),1)]),_:1},8,["type"])]),_:1}),t(c,{label:"注册时间"},{default:l(()=>[o(r(R(u.value.created_at)),1)]),_:1})]),_:1})])):L("",!0)]),_:1},8,["modelValue"])])}}},ut=K(Oe,[["__scopeId","data-v-592eef3f"]]);export{ut as default};
