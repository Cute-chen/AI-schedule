import{e as A,w as M}from"./index-bcd0f302.js";/* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";/* empty css                     *//* empty css               *//* empty css                *//* empty css                     */import{_ as B}from"./_plugin-vue_export-helper-8da67cfc.js";/* empty css                  */import{W as D}from"./WeekRangeSelector-08a2a9b6.js";import{E as i,a2 as C,a4 as F,a5 as T,X as N,p as q,_ as z,aj as O,M as P,ak as U}from"./elementPlus-9365ac08.js";import{r as g,X,k as $,y as p,z as w,A as d,Q as a,I as t,P as h,a4 as E,M as c,O as _,H as I}from"./vendor-b2a91a46.js";import"./utils-88d415ea.js";/* empty css                 *//* empty css                        */import"./settingsService-87306db1.js";const j={class:"work-hours-statistics"},L={class:"weekly-detail"},Q={__name:"WorkHoursStatistics",setup(G){const m=g(!1),n=g([]),u=g([]),l=X({employeeId:"",weekRange:[1,4]}),x=async()=>{var s;try{const e=await A.getEmployees();console.log("å‘˜å·¥APIå“åº”:",e),e.success?n.value=((s=e.data)==null?void 0:s.data)||e.data||[]:e.data?n.value=Array.isArray(e.data)?e.data:e.data.data||[]:n.value=[],console.log("åŠ è½½çš„å‘˜å·¥æ•°æ®:",n.value)}catch(e){console.error("åŠ è½½å‘˜å·¥åˆ—è¡¨å¤±è´¥:",e),i.error("åŠ è½½å‘˜å·¥åˆ—è¡¨å¤±è´¥")}},H=async()=>{if(!l.weekRange||l.weekRange.length===0){i.warning("è¯·é€‰æ‹©å‘¨æœŸèŒƒå›´");return}m.value=!0;try{const s={startWeek:Math.min(...l.weekRange),endWeek:Math.max(...l.weekRange)};l.employeeId&&(s.employeeId=l.employeeId),console.log("æŸ¥è¯¢å‚æ•°:",s);const e=await M.getAllEmployeesWorkHours(s);e.success?(l.employeeId?u.value=[e.data]:u.value=e.data.employees||[],console.log("å·¥æ—¶æ•°æ®:",u.value),i.success("å·¥æ—¶ç»Ÿè®¡æŸ¥è¯¢æˆåŠŸ")):i.error(e.message||"æŸ¥è¯¢å·¥æ—¶ç»Ÿè®¡å¤±è´¥")}catch(s){console.error("æŸ¥è¯¢å·¥æ—¶ç»Ÿè®¡å¤±è´¥:",s),i.error("æŸ¥è¯¢å·¥æ—¶ç»Ÿè®¡å¤±è´¥")}finally{m.value=!1}};return $(()=>{x()}),(s,e)=>{const k=F,V=T,y=N,W=q,R=z,v=C,r=O,b=P,S=U;return p(),w("div",j,[e[4]||(e[4]=d("div",{class:"page-header"},[d("h1",null,"ðŸ“Š å·¥æ—¶ç»Ÿè®¡"),d("p",null,"æŸ¥çœ‹å‘˜å·¥å·¥æ—¶æ•°æ®")],-1)),a(v,{class:"filter-section"},{default:t(()=>[a(R,{model:l,inline:""},{default:t(()=>[a(y,{label:"å‘˜å·¥é€‰æ‹©"},{default:t(()=>[a(V,{modelValue:l.employeeId,"onUpdate:modelValue":e[0]||(e[0]=o=>l.employeeId=o),placeholder:"é€‰æ‹©å‘˜å·¥ï¼ˆç©ºä¸ºå…¨éƒ¨ï¼‰",clearable:"",style:{width:"200px"}},{default:t(()=>[a(k,{label:"å…¨éƒ¨å‘˜å·¥",value:""}),(p(!0),w(h,null,E(n.value,o=>(p(),I(k,{key:o.id,label:`${o.name} (${o.employee_no})`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(y,{label:"å‘¨æœŸèŒƒå›´"},{default:t(()=>[a(D,{modelValue:l.weekRange,"onUpdate:modelValue":e[1]||(e[1]=o=>l.weekRange=o),"max-weeks":52},null,8,["modelValue"])]),_:1}),a(y,null,{default:t(()=>[a(W,{type:"primary",onClick:H,loading:m.value},{default:t(()=>e[2]||(e[2]=[c(" æŸ¥è¯¢ ",-1)])),_:1,__:[2]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),a(v,{class:"data-section"},{header:t(()=>e[3]||(e[3]=[d("span",null,"å·¥æ—¶ç»Ÿè®¡ç»“æžœ",-1)])),default:t(()=>[a(S,{data:u.value,stripe:"",loading:m.value,"empty-text":"æš‚æ— å·¥æ—¶æ•°æ®ï¼Œè¯·å…ˆæŸ¥è¯¢"},{default:t(()=>[a(r,{prop:"employeeInfo.name",label:"å‘˜å·¥å§“å",width:"120"}),a(r,{prop:"employeeInfo.employee_no",label:"å‘˜å·¥ç¼–å·",width:"120"}),a(r,{prop:"employeeInfo.position",label:"èŒä½",width:"120"}),a(r,{prop:"statistics.totalHours",label:"æ€»å·¥æ—¶",width:"100"},{default:t(o=>[a(b,{type:"primary"},{default:t(()=>[c(_(o.row.statistics.totalHours)+"h",1)]),_:2},1024)]),_:1}),a(r,{prop:"statistics.workDays",label:"å·¥ä½œå¤©æ•°",width:"100"}),a(r,{prop:"statistics.totalShifts",label:"æ€»ç­æ¬¡",width:"100"}),a(r,{prop:"statistics.averageDailyHours",label:"æ—¥å‡å·¥æ—¶",width:"100"},{default:t(o=>[c(_(o.row.statistics.averageDailyHours)+"h ",1)]),_:1}),a(r,{label:"æŒ‰å‘¨æ˜Žç»†","min-width":"300"},{default:t(o=>[d("div",L,[(p(!0),w(h,null,E(o.row.statistics.weeklyStats,f=>(p(),I(b,{key:f.week,size:"small",style:{"margin-right":"5px","margin-bottom":"2px"}},{default:t(()=>[c(" ç¬¬"+_(f.week)+"å‘¨: "+_(f.hours)+"h ",1)]),_:2},1024))),128))])]),_:1})]),_:1},8,["data","loading"])]),_:1})])}}},ce=B(Q,[["__scopeId","data-v-f5e472ca"]]);export{ce as default};
